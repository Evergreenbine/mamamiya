<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="app.vo.Circle">

    <select id="listCircle" parameterType="Integer" resultType="app.vo.Circle">
        select * from circle
        <if test="limit != null">
            limit #{limit} ;
        </if>

    </select>

    <insert id="createPost" parameterType="app.vo.Post">
        insert  into post(title, author, content, time, useraccount, cid) value (
        #{title},#{author},#{content},#{time},#{useraccount},#{cid}
        )
    </insert>



    <select id="queryPost" parameterType="map" resultType="app.vo.Post">
        select * from post p ,user u where p.useraccount = u.useraccount and p.cid = #{cid}
        <if test="pid != null">
             and p.pid = #{pid}
        </if>
        <if test="useraccount != null">
            and u.useraccount = #{useraccount}
        </if>
    </select>

<!--    知识的-->
<!--    查询指定id-->
    <select id="queryKonwById" parameterType="int" resultType="app.vo.KnowlegeVo">
        select * from konwledge
        where kid = #{kid};
    </select>

<!--    根据分类查询所有知识-->
    <select id="querykonw" resultType="app.vo.KnowlegeVo">
        select * from konwledge where cata = #{cid}
    </select>
<!--    查看该用户对应的知识是否免费-->
    <select id="queryIsFree" parameterType="map" resultType="map">
        select * from konwuser where kid = #{kid} and userid = #{useraccount}
    </select>


<!--    知识付费-->
    <insert id="purchasekonw" parameterType="map" >
        insert into konwuser(kid, userid) value (#{kid},#{useraccount})
    </insert>
    <update id="demoney" parameterType="map">
        update user set monney = #{monney} where useraccount = #{useraccount}
    </update>
    <select id="getmoney" parameterType="int" resultType="double">
        select monney from user where useraccount = #{useraccount}
    </select>

<!--    查询问题分类-->
    <select id="queryQuesCata"  resultType="app.vo.Qcata">
        select * from qcata;
    </select>

<!--    新建提问-->
    <insert id="createques" parameterType="app.vo.Question">
        insert into question(useraccount, title, content, qcid, createtime)
        value(#{useraccount},#{title},#{content},#{qcid},#{createtime})
    </insert>

<!--    按类型查询问题-->
    <select id="queryQuesbycata" parameterType="map" resultType="app.vo.Question">
        select * from question q,user u where  q.useraccount = u.useraccount and qcid = #{qcid}
    </select>

<!--    按qid查找问题-->
    <select id="quesryQuesByqid" parameterType="map" resultType="app.vo.Question">
         select * from question q,user u where  q.useraccount = u.useraccount and qid = #{qid}
    </select>

<!--    按qid 查找回复-->
    <select id="quesreply" parameterType="int" resultType="app.vo.Reply">
        select * from reply r ,user u where r.useraccount = u.useraccount and r.qid = #{qid}
    </select>




</mapper>